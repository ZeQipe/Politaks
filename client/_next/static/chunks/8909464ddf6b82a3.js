(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,94102,e=>{"use strict";var l=e.i(43476),t=e.i(932),r=e.i(57688),n=e.i(53145);e.i(91268);var a=e.i(94643),i=e.i(95770);e.i(92916);var o=e.i(77086),s=function(e){var r,n,s,c,d=(0,t.c)(10),u=e.isLoading,m=u?"Обработка...":"Отправить";return d[0]!==u?(r=u&&(0,l.jsx)(i.Spinner,{className:"animate-spin text-dark w-4 h-4"}),d[0]=u,d[1]=r):r=d[1],d[2]!==m?(n=(0,l.jsx)(o.Text,{uppercase:!0,weight:"bold",color:"black",size:"sm",children:m}),d[2]=m,d[3]=n):n=d[3],d[4]!==r||d[5]!==n?(s=(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[r,n]}),d[4]=r,d[5]=n,d[6]=s):s=d[6],d[7]!==u||d[8]!==s?(c=(0,l.jsx)("div",{className:"",children:(0,l.jsx)(a.Button,{disabled:u,type:"submit",variant:"submit",children:s})}),d[7]=u,d[8]=s,d[9]=c):c=d[9],c},c=e.i(20786),d=e.i(51682),u=e.i(40316),m=e.i(25526),f=e.i(71645),h=e.i(64899);e.i(33451);var b=e.i(23042);e.i(4075);var v=e.i(64761);e.i(67496);var x=e.i(92626);e.i(91140);var p=e.i(27956),g=e.i(42010),j=(0,g.tv)({slots:{icon:"transition-transform duration-200",selectedContainer:"flex flex-wrap gap-2 mb-2",selectedItem:["inline-flex items-center gap-2 px-3 py-1.5","bg-secondary text-dark rounded-sm","shadow-sm","transition-all duration-150","hover:shadow-md hover:-translate-y-0.5"],removeButton:["ml-1 w-4 h-4","flex items-center justify-center","text-dark/60 hover:text-primary","transition-colors duration-150","cursor-pointer","active:scale-90"],dropdownItem:["px-4 py-2 cursor-pointer transition-colors flex items-center gap-2","first:rounded-t-sm last:rounded-b-sm"],checkmark:"w-4 h-4 flex items-center justify-center text-xs font-bold"},variants:{isOpen:{true:{icon:"rotate-180"},false:{icon:"rotate-0"}},isSelected:{true:{dropdownItem:"bg-primary-50 hover:bg-primary-100",checkmark:"text-primary-600"},false:{dropdownItem:"hover:bg-gray-100",checkmark:"text-transparent"}}}}),y=function(e){var r,n,a,i,o,s,c=(0,t.c)(23),d=e.items,m=e.value,x=e.label,g=e.labelPlacement,y=e.iconPlacement,w=e.placeholder,_=e.error,C=e.onChange,N=e.className,P=e.disabled,I=e.withSearch;c[0]!==m?(r=void 0===m?[]:m,c[0]=m,c[1]=r):r=c[1];var F=r,T=void 0===g?"top":g,L=void 0===y?"right":y,E=(0,f.useId)();c[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,p.inputElementTokens)({state:"readonly"}),c[2]=n):n=c[2];var q=n;c[3]===Symbol.for("react.memo_cache_sentinel")?(a=j(),c[3]=a):a=c[3];var z=a;c[4]!==d||c[5]!==F?(c[7]!==F?(o=function(e){return F.includes(e.label)},c[7]=F,c[8]=o):o=c[8],i=d.filter(o),c[4]=d,c[5]=F,c[6]=i):i=c[6];var D=i;return c[9]!==N||c[10]!==P||c[11]!==_||c[12]!==L||c[13]!==E||c[14]!==d||c[15]!==x||c[16]!==T||c[17]!==C||c[18]!==w||c[19]!==D||c[20]!==F||c[21]!==I?(s=(0,l.jsx)(h.DropdownToggle,{children:function(e){var t=e.isOpen,r=e.toggle,n=e.ref,a=function(e,l){e.stopPropagation();var t=D.filter(function(e){return e.id!==l.id});null==C||C(t)},i=D.length>0?"Выбрано: ".concat(D.length):"";return(0,l.jsxs)("div",{ref:n,className:N,children:[D.length>0&&(0,l.jsx)("div",{className:z.selectedContainer(),children:D.map(function(e){return(0,l.jsxs)("span",{className:z.selectedItem(),children:[e.label,(0,l.jsx)("button",{type:"button",className:z.removeButton(),onClick:function(l){return a(l,e)},children:"✕"})]},e.id)})}),(0,l.jsxs)(v.InputWrapper,{disabled:P,id:E,label:x,error:_,labelPlacement:T,iconPlacement:L,inputType:"select",state:"readonly",onClick:r,dropdown:t&&(0,l.jsx)(k,{items:d,selectedIds:D.map(S),onItemClick:function(e){var l;l=F.includes(e.label)?D.filter(function(l){return l.id!==e.id}):(0,u._)(D).concat([e]),null==C||C(l)},withSearch:I}),children:[(0,l.jsx)("div",{className:"grid place-items-center",children:(0,l.jsx)(b.ArrowIcon,{className:z.icon({isOpen:t})})}),(0,l.jsx)("input",{id:E,disabled:P,type:"text",className:q,value:i,placeholder:w,readOnly:!0})]})]})}}),c[9]=N,c[10]=P,c[11]=_,c[12]=L,c[13]=E,c[14]=d,c[15]=x,c[16]=T,c[17]=C,c[18]=w,c[19]=D,c[20]=F,c[21]=I,c[22]=s):s=c[22],s};function k(e){var r,n=(0,t.c)(25),a=e.items,i=e.selectedIds,o=e.onItemClick,s=e.withSearch,c=(0,d._)(f.default.useState(""),2),u=c[0],h=c[1],b=(0,m.useDebounce)(u,300);n[0]===Symbol.for("react.memo_cache_sentinel")?(p=function(e){h(e.target.value)},n[0]=p):p=n[0];var v=p;if(n[1]!==b||n[2]!==a||n[3]!==o||n[4]!==u||n[5]!==i||n[6]!==s){n[11]!==b?(w=function(e){return e.label.toLowerCase().includes(b.toLowerCase())},n[11]=b,n[12]=w):w=n[12];var p,g,y,k,S,w,_,C,N=a.filter(w);n[13]!==o?(_=function(e){null==o||o(e)},n[13]=o,n[14]=_):_=n[14];var P=_;n[15]!==P?(C=function(e,l){("Enter"===e.key||" "===e.key)&&(e.preventDefault(),P(l))},n[15]=P,n[16]=C):C=n[16];var I=C,F=j();g="menu",y="absolute z-50 w-full rounded-sm bg-white shadow-lg border-transparent max-h-[200px] overflow-y-auto scroll-base top-full mt-5",n[17]!==u||n[18]!==s?(k=s&&(0,l.jsx)("div",{className:"px-4 py-2",children:(0,l.jsx)(x.TextField,{onChange:v,placeholder:"Поиск",showFloatingHint:!0,value:u})}),n[17]=u,n[18]=s,n[19]=k):k=n[19],S=N.map(function(e){var t=i.includes(e.id);return(0,l.jsxs)("div",{className:F.dropdownItem({isSelected:t}),onClick:function(){return P(e)},onKeyDown:function(l){return I(l,e)},role:"menuitem",tabIndex:0,children:[(0,l.jsx)("span",{className:F.checkmark({isSelected:t}),children:"✓"}),(0,l.jsx)("span",{children:e.label})]},e.id)}),n[1]=b,n[2]=a,n[3]=o,n[4]=u,n[5]=i,n[6]=s,n[7]=g,n[8]=y,n[9]=k,n[10]=S}else g=n[7],y=n[8],k=n[9],S=n[10];return n[20]!==g||n[21]!==y||n[22]!==k||n[23]!==S?(r=(0,l.jsxs)("div",{role:g,className:y,children:[k,S]}),n[20]=g,n[21]=y,n[22]=k,n[23]=S,n[24]=r):r=n[24],r}function S(e){return e.id}e.i(20227);var w=e.i(9278);e.i(95650);var _=e.i(36792),C=(0,g.tv)({slots:{label:"w-fit pr-3 peer border-r border-r-neutral-400 text-sm text-zinc-600",output:"w-fit pl-3 text-sm text-zinc-600"},variants:{state:{focus:{label:"border-r-primary"},default:{}}},defaultVariants:{state:"default"}}),N=function(e){var r,n,a,i,o=(0,t.c)(57),s=e.labelPlacement,c=e.iconPlacement,u=e.label,h=e.disabled,b=e.onChange,x=e.error,p=(0,d._)((0,f.useState)(!1),2),g=p[0],j=p[1],y=(0,d._)((0,f.useState)(""),2),k=y[0],S=y[1],w=(0,f.useId)();o[0]===Symbol.for("react.memo_cache_sentinel")?(I=function(){return j(!1)},o[0]=I):I=o[0];var _=(0,m.useClickAway)(I);o[1]!==b?(F=function(e){var l,t=null==(l=e.target.files)?void 0:l[0];S(t?t.name:""),j(!1),null==b||b(e)},o[1]=b,o[2]=F):F=o[2];var N=F,P=g?"focus":"default";if(o[3]!==h||o[4]!==x||o[5]!==N||o[6]!==c||o[7]!==w||o[8]!==u||o[9]!==s||o[10]!==_||o[11]!==P){var I,F,T,L,E,q,z,D,A,O,B,H,W,G,K,M,V,R,Q,U=C({state:P});O="w-fit",B=_,T=v.InputWrapper,V=h,R=P,L=s,E=c,q=w,z=u,D="file",A=x,G="flex w-full items-center",K=(0,l.jsx)("label",{htmlFor:w,className:U.label(),children:"Выберите файл"}),o[28]===Symbol.for("react.memo_cache_sentinel")?(Q=function(){return j(!0)},o[28]=Q):Q=o[28],o[29]!==h||o[30]!==N||o[31]!==w?(M=(0,l.jsx)("input",{disabled:h,onClick:Q,onChange:N,id:w,className:"hidden",type:"file"}),o[29]=h,o[30]=N,o[31]=w,o[32]=M):M=o[32],H=w,W=U.output(),o[3]=h,o[4]=x,o[5]=N,o[6]=c,o[7]=w,o[8]=u,o[9]=s,o[10]=_,o[11]=P,o[12]=T,o[13]=L,o[14]=E,o[15]=q,o[16]=z,o[17]=D,o[18]=A,o[19]=O,o[20]=B,o[21]=H,o[22]=W,o[23]=G,o[24]=K,o[25]=M,o[26]=V,o[27]=R}else T=o[12],L=o[13],E=o[14],q=o[15],z=o[16],D=o[17],A=o[18],O=o[19],B=o[20],H=o[21],W=o[22],G=o[23],K=o[24],M=o[25],V=o[26],R=o[27];var J=k||"Файл не выбран";return o[33]!==J||o[34]!==H||o[35]!==W?(r=(0,l.jsx)("output",{htmlFor:H,className:W,children:J}),o[33]=J,o[34]=H,o[35]=W,o[36]=r):r=o[36],o[37]!==r||o[38]!==G||o[39]!==K||o[40]!==M?(n=(0,l.jsxs)("div",{className:G,children:[K,M,r]}),o[37]=r,o[38]=G,o[39]=K,o[40]=M,o[41]=n):n=o[41],o[42]!==T||o[43]!==L||o[44]!==E||o[45]!==q||o[46]!==z||o[47]!==D||o[48]!==A||o[49]!==n||o[50]!==V||o[51]!==R?(a=(0,l.jsx)(T,{disabled:V,state:R,labelPlacement:L,iconPlacement:E,id:q,label:z,inputType:D,error:A,children:n}),o[42]=T,o[43]=L,o[44]=E,o[45]=q,o[46]=z,o[47]=D,o[48]=A,o[49]=n,o[50]=V,o[51]=R,o[52]=a):a=o[52],o[53]!==O||o[54]!==B||o[55]!==a?(i=(0,l.jsx)("div",{className:O,ref:B,children:a}),o[53]=O,o[54]=B,o[55]=a,o[56]=i):i=o[56],i};function P(e){var r=(0,t.c)(67),a=e.field,i=e.control,o=e.index,s="fields.".concat(o,".value");r[0]!==i?(u={control:i},r[0]=i,r[1]=u):u=r[1];var d=(0,n.useFormState)(u).isSubmitting;switch(a.type){case"single":var u,m,f,h,b=a.required&&"Обязательное поле";return r[2]!==b?(m={required:b},r[2]=b,r[3]=m):m=r[3],r[4]!==a.label||r[5]!==a.labelPlacement||r[6]!==a.placeholder||r[7]!==a.showFloatingHint||r[8]!==d?(f=function(e){var t,r=e.field,n=e.fieldState;return(0,l.jsx)(x.TextField,(0,c._)({showFloatingHint:a.showFloatingHint,label:a.label,placeholder:a.placeholder,labelPlacement:a.labelPlacement,error:null==(t=n.error)?void 0:t.message,disabled:d},r))},r[4]=a.label,r[5]=a.labelPlacement,r[6]=a.placeholder,r[7]=a.showFloatingHint,r[8]=d,r[9]=f):f=r[9],r[10]!==i||r[11]!==s||r[12]!==m||r[13]!==f?(h=(0,l.jsx)(n.Controller,{name:s,control:i,rules:m,render:f}),r[10]=i,r[11]=s,r[12]=m,r[13]=f,r[14]=h):h=r[14],h;case"multiline":var v,p,g,j=a.required&&"Обязательное поле";return r[15]!==j?(v={required:j},r[15]=j,r[16]=v):v=r[16],r[17]!==a.label||r[18]!==a.labelPlacement||r[19]!==a.placeholder||r[20]!==a.size||r[21]!==d?(p=function(e){var t,r=e.field,n=e.fieldState;return(0,l.jsx)(_.TextArea,(0,c._)({label:a.label,placeholder:a.placeholder,labelPlacement:a.labelPlacement,size:a.size,error:null==(t=n.error)?void 0:t.message,disabled:d},r))},r[17]=a.label,r[18]=a.labelPlacement,r[19]=a.placeholder,r[20]=a.size,r[21]=d,r[22]=p):p=r[22],r[23]!==i||r[24]!==s||r[25]!==v||r[26]!==p?(g=(0,l.jsx)(n.Controller,{name:s,control:i,rules:v,render:p}),r[23]=i,r[24]=s,r[25]=v,r[26]=p,r[27]=g):g=r[27],g;case"photo":var k,S,C,P=a.required&&"Обязательное поле";return r[28]!==P?(k={required:P},r[28]=P,r[29]=k):k=r[29],r[30]!==a.label||r[31]!==a.labelPlacement||r[32]!==d?(S=function(e){var t,r=e.field,n=e.fieldState;return(0,l.jsx)(N,{label:a.label,labelPlacement:a.labelPlacement,error:null==(t=n.error)?void 0:t.message,disabled:d,onChange:function(e){var l,t=null==(l=e.target.files)?void 0:l[0];r.onChange(t)}})},r[30]=a.label,r[31]=a.labelPlacement,r[32]=d,r[33]=S):S=r[33],r[34]!==i||r[35]!==s||r[36]!==k||r[37]!==S?(C=(0,l.jsx)(n.Controller,{name:s,control:i,rules:k,render:S}),r[34]=i,r[35]=s,r[36]=k,r[37]=S,r[38]=C):C=r[38],C;case"select":if(a.multiple){var F,T,L,E,q,z,D=a.required&&"Обязательное поле";return r[39]!==D?(E={required:D},r[39]=D,r[40]=E):E=r[40],r[41]!==a.items||r[42]!==a.label||r[43]!==a.labelPlacement||r[44]!==a.placeholder||r[45]!==a.withSearch||r[46]!==d?(q=function(e){var t,r=e.field,n=e.fieldState,i=Array.isArray(r.value)?r.value:[];return(0,l.jsx)(y,{label:a.label,items:a.items,placeholder:a.placeholder,withSearch:a.withSearch,labelPlacement:a.labelPlacement,error:null==(t=n.error)?void 0:t.message,disabled:d,value:i,onChange:function(e){r.onChange(e.map(I))}})},r[41]=a.items,r[42]=a.label,r[43]=a.labelPlacement,r[44]=a.placeholder,r[45]=a.withSearch,r[46]=d,r[47]=q):q=r[47],r[48]!==i||r[49]!==s||r[50]!==E||r[51]!==q?(z=(0,l.jsx)(n.Controller,{name:s,control:i,rules:E,render:q}),r[48]=i,r[49]=s,r[50]=E,r[51]=q,r[52]=z):z=r[52],z}var A=a.required&&"Обязательное поле";return r[53]!==A?(F={required:A},r[53]=A,r[54]=F):F=r[54],r[55]!==a.items||r[56]!==a.label||r[57]!==a.labelPlacement||r[58]!==a.placeholder||r[59]!==a.withSearch||r[60]!==d?(T=function(e){var t,r=e.field,n=e.fieldState;return(0,l.jsx)(w.Select,{label:a.label,items:a.items,placeholder:a.placeholder,withSearch:a.withSearch,labelPlacement:a.labelPlacement,error:null==(t=n.error)?void 0:t.message,disabled:d,value:r.value,onChange:function(e){r.onChange(e.label)}})},r[55]=a.items,r[56]=a.label,r[57]=a.labelPlacement,r[58]=a.placeholder,r[59]=a.withSearch,r[60]=d,r[61]=T):T=r[61],r[62]!==i||r[63]!==s||r[64]!==F||r[65]!==T?(L=(0,l.jsx)(n.Controller,{name:s,control:i,rules:F,render:T}),r[62]=i,r[63]=s,r[64]=F,r[65]=T,r[66]=L):L=r[66],L;default:return console.warn("Неизвестный тип поля:",a),null}}function I(e){return e.label}e.i(7948);var F=e.i(17098),T=function(){var e,r=(0,t.c)(1);return r[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,l.jsxs)("div",{className:"flex flex-1 flex-col gap-4",children:[(0,l.jsx)(F.SkeletonInput,{labelPlacement:"top",showLabel:!0,multiline:!1}),(0,l.jsx)(F.SkeletonInput,{labelPlacement:"top",showLabel:!0,multiline:!0,textareaSize:"md"}),(0,l.jsx)(F.SkeletonInput,{labelPlacement:"top",showLabel:!0,multiline:!1})]}),r[0]=e):e=r[0],e},L=function(e){var r,n,a,i,o=(0,t.c)(8),s=e.control,c=e.fields;return e.isLoading||0===c.length?(o[0]===Symbol.for("react.memo_cache_sentinel")?(r=(0,l.jsx)(T,{}),o[0]=r):r=o[0],r):(o[1]!==s||o[2]!==c?(o[4]!==s?(a=function(e,t){return(0,l.jsx)(P,{field:e,control:s,index:t},e.id)},o[4]=s,o[5]=a):a=o[5],n=c.map(a),o[1]=s,o[2]=c,o[3]=n):n=o[3],o[6]!==n?(i=(0,l.jsx)("div",{className:"flex grow flex-col gap-4",children:n}),o[6]=n,o[7]=i):i=o[7],i)},E=e.i(92808),q=e.i(66027),z=e.i(52069),D=e.i(28476),A=function(e){var l,r,n,a=(0,t.c)(12),i=e.taskId,o=e.modelId,s=e.domainId,c=e.enabled;a[0]!==s||a[1]!==o||a[2]!==i?(l=z.apiKeys.getGenerationFormConfig(i,o,s),a[0]=s,a[1]=o,a[2]=i,a[3]=l):l=a[3],a[4]!==s||a[5]!==o||a[6]!==i?(r=function(){return(0,D.getGenerationFormConfig)({taskId:i,modelId:o,domainId:s})},a[4]=s,a[5]=o,a[6]=i,a[7]=r):r=a[7];var d=(void 0===c||c)&&!!i&&!!o&&!!s;return a[8]!==l||a[9]!==r||a[10]!==d?(n={queryKey:l,queryFn:r,enabled:d,staleTime:3e5},a[8]=l,a[9]=r,a[10]=d,a[11]=n):n=a[11],(0,q.useQuery)(n)},O=function(e){var l,r,n,a=(0,t.c)(9),i=e.taskId,o=e.modelId,s=e.domainId,c=e.replace,d=e.enabled,u=void 0===d||d;a[0]!==s||a[1]!==u||a[2]!==o||a[3]!==i?(l={taskId:i,modelId:o,domainId:s,enabled:u},a[0]=s,a[1]=u,a[2]=o,a[3]=i,a[4]=l):l=a[4];var m=A(l);return a[5]!==m.data||a[6]!==c?(r=function(){m.data&&(console.log("\uD83D\uDD04 Синхронизация формы с конфигурацией"),c(m.data.map(B)))},n=[m.data,c],a[5]=m.data,a[6]=c,a[7]=r,a[8]=n):(r=a[7],n=a[8]),(0,f.useEffect)(r,n),m};function B(e){var l="";return"photo"===e.type?l=null:"select"===e.type&&e.multiple&&(l=[]),(0,E._)((0,c._)({},e),{value:l})}var H=function(e){var r,a,i,o,s=(0,t.c)(18),c=e.control,d=e.field;s[0]!==c?(r={control:c},s[0]=c,s[1]=r):r=s[1];var u=(0,n.useFormState)(r).isSubmitting,m=d.required&&"Обязательное поле";return s[2]!==d.validate||s[3]!==m?(a={required:m,validate:d.validate},s[2]=d.validate,s[3]=m,s[4]=a):a=s[4],s[5]!==d.disabled||s[6]!==d.label||s[7]!==d.labelPlacement||s[8]!==d.placeholder||s[9]!==d.showFloatingHint||s[10]!==d.type||s[11]!==u?(i=function(e){var t,r,n=e.field,a=e.fieldState;return(0,l.jsx)(x.TextField,{type:null!=(r=d.type)?r:"text",showFloatingHint:d.showFloatingHint,label:d.label,placeholder:d.placeholder,labelPlacement:d.labelPlacement,error:null==(t=a.error)?void 0:t.message,disabled:d.disabled||u,value:n.value,onChange:n.onChange,onBlur:n.onBlur,name:n.name})},s[5]=d.disabled,s[6]=d.label,s[7]=d.labelPlacement,s[8]=d.placeholder,s[9]=d.showFloatingHint,s[10]=d.type,s[11]=u,s[12]=i):i=s[12],s[13]!==c||s[14]!==d.name||s[15]!==a||s[16]!==i?(o=(0,l.jsx)(n.Controller,{control:c,name:d.name,rules:a,render:i}),s[13]=c,s[14]=d.name,s[15]=a,s[16]=i,s[17]=o):o=s[17],o};e.i(82131);var W=e.i(61122),G=e.i(57033);let K={src:e.i(27215).default,width:10,height:10,blurWidth:0,blurHeight:0};var M=function(e,l){var t,r,n=null==(t=e[l])?void 0:t.items;if(null==n?void 0:n.length)return null!=(r=n.find(function(e){return e.default}))?r:n[0]},V=e.i(31398),R=function(e){var l,t=e.filters,r=(0,f.useMemo)(function(){if(t){var e,l,r=t.tasks,n=t.models;if((null==r||null==(e=r.items)?void 0:e.length)&&(null==n||null==(l=n.items)?void 0:l.length))return{tasks:r,models:n}}},[t]),a=(0,d._)((0,f.useState)(!1),2),i=a[0],o=a[1],s=(0,n.useForm)({defaultValues:{filters:{task:{id:"_all",label:"Все",value:"_all"},model:M(t||{},"models")},excelLink:"",range:{from:3,to:0}}});(0,V.useFiltersSynchronization)({filtersData:r,form:s,resetCallback:function(){return{filters:{task:{id:"_all",label:"Все",value:"_all"},model:M(r||{},"models")},excelLink:"",range:{from:3,to:0}}}});var m=s.watch("filters.task"),h=(null==m?void 0:m.id)==="_all";return(0,f.useEffect)(function(){h&&(s.setValue("range.from",3),s.setValue("range.to",0))},[h,s]),{form:s,formConfig:(0,f.useMemo)(function(){return{excelLink:{name:"excelLink",label:"Ссылка на файл Excel",placeholder:"Введите ссылку на Excel файл",labelPlacement:"top",required:!0,type:"text"},rangeFrom:{name:"range.from",label:"С строки",placeholder:"Номер строки",labelPlacement:"left",required:!0,type:"number",disabled:h,validate:function(e){return void 0===e||!(("string"==typeof e?Number(e):e)<3)||"Минимальное значение — 3"}},rangeTo:{name:"range.to",label:"До строки",placeholder:"Номер строки",labelPlacement:"left",required:!0,type:"number",disabled:h,validate:function(e){if(void 0===e)return!0;var l="string"==typeof e?Number(e):e;return 0===l||!(l<3)||"Допустимые значения: 0 или ≥ 3"}}}},[h]),filtersConfig:{tasks:(null==t?void 0:t.tasks)?(l=t.tasks,(0,E._)((0,c._)({},l),{items:[{id:"_all",label:"Все",value:"_all"}].concat((0,u._)(l.items))})):{items:[],label:""},models:(null==t?void 0:t.models)||{items:[],label:""}},handleClose:function(){return o(!1)},handleOpen:function(){return o(!0)},isOpen:i}};e.i(47167);var Q=e.i(91865),U=e.i(96137),J=e.i(5766),X=e.i(54616),Y=function(){var e,l=(0,t.c)(1);return l[0]===Symbol.for("react.memo_cache_sentinel")?(e={mutationKey:["generate-excel"],mutationFn:D.postExcelGeneration},l[0]=e):e=l[0],(0,X.useMutation)(e)},Z=function(e,l){var r,n,a,i=(0,t.c)(9),o=Y().mutateAsync;i[0]!==e||i[1]!==o||i[2]!==l?(r=function(t){return(0,Q._)(function(){return(0,U._)(this,function(r){switch(r.label){case 0:if(!t.filters.task||!t.filters.model)return J.default.error("Все фильтры должны быть выбраны"),[2];if(!t.excelLink.trim())return J.default.error("Ссылка на Excel обязательна"),[2];return[4,o({filters:{taskId:t.filters.task.id,modelId:t.filters.model.id},excelLink:t.excelLink,range:{from:t.range.from,to:t.range.to}},{onSuccess:function(t){t.data,J.default.success("Excel успешно обработан!"),e.reset(),null==l||l()},onError:$})];case 1:return r.sent(),[2]}})})()},i[0]=e,i[1]=o,i[2]=l,i[3]=r):r=i[3];var s=r;return i[4]!==e||i[5]!==s?(n=e.handleSubmit(s),i[4]=e,i[5]=s,i[6]=n):n=i[6],i[7]!==n?(a={handleSubmit:n},i[7]=n,i[8]=a):a=i[8],a};function $(e){console.error("❌ Ошибка генерации из Excel: ",e.message),J.default.error("Ошибка генерации: ".concat(e.message))}var ee=e.i(17878),el=function(){var e,l,r,a=(0,t.c)(9),i=(0,ee.useGetGenerationFilters)(),o=i.data,s=i.isLoading,c=i.isError;a[0]===Symbol.for("react.memo_cache_sentinel")?(e={defaultValues:{filters:{task:void 0,model:void 0,domain:void 0},fields:[]}},a[0]=e):e=a[0];var d=(0,n.useForm)(e);a[1]!==o||a[2]!==d?(l={filtersData:o,form:d,resetCallback:et},a[1]=o,a[2]=d,a[3]=l):l=a[3];var u=(0,V.useFiltersSynchronization)(l).isInitialized,m=s||!u;return a[4]!==o||a[5]!==d||a[6]!==c||a[7]!==m?(r={form:d,filtersData:o,isLoading:m,isError:c},a[4]=o,a[5]=d,a[6]=c,a[7]=m,a[8]=r):r=a[8],r};function et(e){return{filters:{task:M(e,"tasks"),model:M(e,"models"),domain:M(e,"domains")},fields:[]}}var er=function(){var e,l=(0,t.c)(1);return l[0]===Symbol.for("react.memo_cache_sentinel")?(e={mutationKey:["generate-content"],mutationFn:D.postGeneration},l[0]=e):e=l[0],(0,X.useMutation)(e)},en=function(e){var l,r,n,a=(0,t.c)(8),i=er().mutateAsync;a[0]!==e||a[1]!==i?(l=function(l){return(0,Q._)(function(){var t,r;return(0,U._)(this,function(n){switch(n.label){case 0:if(t=l.fields,!(r=l.filters).task||!r.model||!r.domain)return J.default.error("Все фильтры должны быть выбраны"),[2];return[4,i({filters:{taskId:r.task.id,modelId:r.model.id,domainId:r.domain.id},fields:t.map(ea)},{onSuccess:function(l){l.data,J.default.success("Генерация успешна !");var r=t.map(ei);e.setValue("fields",r)},onError:eo})];case 1:return n.sent(),[2]}})})()},a[0]=e,a[1]=i,a[2]=l):l=a[2];var o=l;return a[3]!==e||a[4]!==o?(r=e.handleSubmit(o),a[3]=e,a[4]=o,a[5]=r):r=a[5],a[6]!==r?(n={handleSubmit:r},a[6]=r,a[7]=n):n=a[7],n};function ea(e){var l,t="";return"select"===e.type&&e.multiple&&(t=[]),{name:e.name,value:null!=(l=e.value)?l:t}}function ei(e){var l="";return"photo"===e.type?l=null:"select"===e.type&&e.multiple&&(l=[]),(0,E._)((0,c._)({},e),{value:l})}function eo(e){console.error("❌ Ошибка генерации: ",e.message),J.default.error("Ошибка генерации: ".concat(e.message))}var es=e.i(74080),ec=(0,g.tv)({slots:{container:"fixed inset-0 flex items-center justify-center",backdrop:"absolute inset-0 bg-black/18 backdrop-blur-sm",modal:"relatiive z-50 border border-neutral-300 shadow-md rounded-xl bg-white"}}),ed=function(e){var r,n=(0,t.c)(4),a=e.children,i=e.open,o=e.onClose;if(n[0]!==a||n[1]!==o||n[2]!==i){var s=ec(),c=s.backdrop,d=s.container,u=s.modal;r=i&&(0,es.createPortal)((0,l.jsxs)("div",{className:d(),children:[(0,l.jsx)("button",{"aria-label":"Close modal",type:"button",onClick:o,className:c()}),(0,l.jsx)("div",{role:"dialog",className:u(),children:a})]}),document.body),n[0]=a,n[1]=o,n[2]=i,n[3]=r}else r=n[3];return r},eu=function(e){var n,s,c,d,u,m,f,h,b,v,x,p,g=(0,t.c)(31),j=e.handleClose,y=e.open,k=e.children,S=e.onSubmit,w=e.isSubmitting;g[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,l.jsx)(o.Text,{as:"legend",className:"text-center w-full",weight:"bold",size:"2xl",children:"Загрузить Excel"}),g[0]=n):n=g[0],g[1]!==k?(s=(0,l.jsxs)("fieldset",{className:"border-none items-center justify-center flex flex-col",children:[n,k]}),g[1]=k,g[2]=s):s=g[2],g[3]!==w?(c=w&&(0,l.jsx)(i.Spinner,{className:"animate-spin text-white w-4 h-4"}),g[3]=w,g[4]=c):c=g[4];var _=w?"Обработка...":"Подтвердить";return g[5]!==_?(d=(0,l.jsx)(o.Text,{size:"sm",uppercase:!0,weight:"medium",color:"white",children:_}),g[5]=_,g[6]=d):d=g[6],g[7]!==c||g[8]!==d?(u=(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[c,d]}),g[7]=c,g[8]=d,g[9]=u):u=g[9],g[10]!==w?(m=!w&&(0,l.jsx)(r.default,{className:"ml-2",alt:"",src:K}),g[10]=w,g[11]=m):m=g[11],g[12]!==w||g[13]!==u||g[14]!==m?(f=(0,l.jsxs)(a.Button,{className:"inline-flex items-center justify-center flex-1",type:"submit",disabled:w,children:[u,m]}),g[12]=w,g[13]=u,g[14]=m,g[15]=f):f=g[15],g[16]===Symbol.for("react.memo_cache_sentinel")?(h=(0,l.jsx)(o.Text,{color:"primary",size:"xs",uppercase:!0,children:"отмена"}),g[16]=h):h=g[16],g[17]!==j||g[18]!==w?(b=(0,l.jsx)(a.Button,{onClick:j,variant:"secondary",disabled:w,children:h}),g[17]=j,g[18]=w,g[19]=b):b=g[19],g[20]!==b||g[21]!==f?(v=(0,l.jsxs)("div",{className:"flex mt-6 gap-3.75",children:[f,b]}),g[20]=b,g[21]=f,g[22]=v):v=g[22],g[23]!==S||g[24]!==v||g[25]!==s?(x=(0,l.jsx)("div",{className:"p-8",children:(0,l.jsxs)("form",{onSubmit:S,children:[s,v]})}),g[23]=S,g[24]=v,g[25]=s,g[26]=x):x=g[26],g[27]!==j||g[28]!==y||g[29]!==x?(p=(0,l.jsx)(ed,{open:y,onClose:j,children:x}),g[27]=j,g[28]=y,g[29]=x,g[30]=p):p=g[30],p},em=function(){var e,i,c,d,u,m,f,h,b,v,x,p,g,j,y,k,S=(0,t.c)(47),w=el(),_=w.filtersData,C=w.form,N=w.isLoading;S[0]!==_?(e={filters:_},S[0]=_,S[1]=e):e=S[1];var P=R(e),I=P.isOpen,F=P.handleOpen,T=P.handleClose,E=P.form,q=P.formConfig,z=P.filtersConfig,D=C.formState.isSubmitting,A=E.formState.isSubmitting,B=en(C).handleSubmit,M=Z(E,T).handleSubmit;S[2]!==C.control?(i={control:C.control,name:"fields"},S[2]=C.control,S[3]=i):i=S[3];var V=(0,n.useFieldArray)(i),Q=V.fields,U=V.replace;S[4]!==C.control?(c={control:C.control,name:"filters.task"},S[4]=C.control,S[5]=c):c=S[5];var J=(0,n.useWatch)(c);S[6]!==C.control?(d={control:C.control,name:"filters.model"},S[6]=C.control,S[7]=d):d=S[7];var X=(0,n.useWatch)(d);S[8]!==C.control?(u={control:C.control,name:"filters.domain"},S[8]=C.control,S[9]=u):u=S[9];var Y=(0,n.useWatch)(u),$=null!=(m=null==J?void 0:J.id)?m:"",ee=null!=(f=null==X?void 0:X.id)?f:"",et=null!=(h=null==Y?void 0:Y.id)?h:"",er=!!((null==J?void 0:J.id)&&(null==X?void 0:X.id)&&(null==Y?void 0:Y.id));S[10]!==U||S[11]!==$||S[12]!==ee||S[13]!==et||S[14]!==er?(b={taskId:$,modelId:ee,domainId:et,replace:U,enabled:er},S[10]=U,S[11]=$,S[12]=ee,S[13]=et,S[14]=er,S[15]=b):b=S[15];var ea=O(b).isLoading;return S[16]!==C.control||S[17]!==F||S[18]!==D?(v=function(e){return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)(W.FilterSelect,{disabled:D,config:e.tasks,control:C.control,name:"filters.task"}),(0,l.jsxs)(a.Button,{className:"inline-flex items-center shrink-0",variant:"primary",onClick:F,children:[(0,l.jsx)(o.Text,{size:"sm",uppercase:!0,weight:"medium",color:"white",children:"Загрузить Excel"}),(0,l.jsx)(r.default,{className:"ml-2",alt:"",src:K})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)(W.FilterSelect,{disabled:D,control:C.control,name:"filters.model",config:e.models}),(0,l.jsx)(W.FilterSelect,{disabled:D,control:C.control,name:"filters.domain",config:e.domains})]})]})},S[16]=C.control,S[17]=F,S[18]=D,S[19]=v):v=S[19],S[20]!==_||S[21]!==N||S[22]!==v?(x=(0,l.jsx)(G.FiltersPanel,{filters:_,isLoading:N,children:v}),S[20]=_,S[21]=N,S[22]=v,S[23]=x):x=S[23],S[24]!==ea||S[25]!==Q||S[26]!==C.control?(p=(0,l.jsx)(L,{control:C.control,fields:Q,isLoading:ea}),S[24]=ea,S[25]=Q,S[26]=C.control,S[27]=p):p=S[27],S[28]!==D?(g=(0,l.jsx)(s,{isLoading:D}),S[28]=D,S[29]=g):g=S[29],S[30]!==B||S[31]!==x||S[32]!==p||S[33]!==g?(j=(0,l.jsxs)("form",{onSubmit:B,className:"flex flex-1 flex-col gap-4",children:[x,p,g]}),S[30]=B,S[31]=x,S[32]=p,S[33]=g,S[34]=j):j=S[34],S[35]!==E.control||S[36]!==z||S[37]!==_||S[38]!==q||S[39]!==T||S[40]!==M||S[41]!==A||S[42]!==I?(y=_&&(0,l.jsx)(eu,{handleClose:T,open:I,onSubmit:M,isSubmitting:A,children:(0,l.jsxs)("div",{className:"mt-4 flex flex-col gap-4",children:[(0,l.jsx)(H,{field:q.excelLink,control:E.control}),(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsx)(W.FilterSelect,{config:z.tasks,control:E.control,name:"filters.task",disabled:A}),(0,l.jsx)(W.FilterSelect,{config:z.models,control:E.control,name:"filters.model",disabled:A})]}),(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsx)(H,{field:q.rangeFrom,control:E.control}),(0,l.jsx)(H,{field:q.rangeTo,control:E.control})]})]})}),S[35]=E.control,S[36]=z,S[37]=_,S[38]=q,S[39]=T,S[40]=M,S[41]=A,S[42]=I,S[43]=y):y=S[43],S[44]!==j||S[45]!==y?(k=(0,l.jsxs)("section",{className:"flex flex-1",children:[j,y]}),S[44]=j,S[45]=y,S[46]=k):k=S[46],k};e.s(["GenerationFormWidget",()=>em],94102)},70330,e=>{"use strict";e.s(["GenerationResultWidget",()=>j,"VIEW_MODES",()=>x],70330);var l=e.i(51682),t=e.i(43476),r=e.i(932),n=e.i(71645);e.i(20786),e.i(92808);var a=e.i(40143),i=e.i(19273),o=e.i(12598);function s(e,l){return e.findAll(l.filters).map(function(e){return l.select?l.select(e):e.state})}var c=function(){var e,l,t=(0,r.c)(3);t[0]===Symbol.for("react.memo_cache_sentinel")?(e={filters:{status:"success",predicate:d},select:u},t[0]=e):e=t[0];var c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=arguments.length>1?arguments[1]:void 0,t=(0,o.useQueryClient)(l).getMutationCache(),r=n.useRef(e),c=n.useRef(null);return null===c.current&&(c.current=s(t,e)),n.useEffect(function(){r.current=e}),n.useSyncExternalStore(n.useCallback(function(e){return t.subscribe(function(){var l=(0,i.replaceEqualDeep)(c.current,s(t,r.current));c.current!==l&&(c.current=l,a.notifyManager.schedule(e))})},[t]),function(){return c.current},function(){return c.current})}(e);return t[1]!==c?(l=c.at(-1),t[1]=c,t[2]=l):l=t[2],l};function d(e){var l,t=null==(l=e.options.mutationKey)?void 0:l[0];return"generate-content"===t||"generate-excel"===t}function u(e){return e.state.data}var m=e.i(97274);e.i(92916);var f=e.i(77086),h=(0,e.i(42010).tv)({slots:{track:"w-8 h-3 rounded-full flex items-center transition",thumb:"block w-4.5 h-4.5 rounded-full transform transition"},variants:{checked:{true:{thumb:"translate-x-4 bg-primary",track:"bg-primary"},false:{thumb:"bg-primary/90",track:"bg-primary/85"}}}}),b=function(e){var l,n,a,i,o,s,c=(0,r.c)(13),d=e.onSwitch,u=e.checked;if(c[0]!==u||c[1]!==d){var m=h({checked:u}),f=m.thumb,b=m.track;n="button",a=d,i=b(),l=f(),c[0]=u,c[1]=d,c[2]=l,c[3]=n,c[4]=a,c[5]=i}else l=c[2],n=c[3],a=c[4],i=c[5];return c[6]!==l?(o=(0,t.jsx)("span",{className:l}),c[6]=l,c[7]=o):o=c[7],c[8]!==n||c[9]!==a||c[10]!==i||c[11]!==o?(s=(0,t.jsx)("button",{type:n,onClick:a,className:i,children:o}),c[8]=n,c[9]=a,c[10]=i,c[11]=o,c[12]=s):s=c[12],s},v=function(e){var n,a,i,o,s,c=(0,r.c)(14),d=e.mode,u=e.onToggle,m=e.labels,h=(0,l._)(x,2),v=h[0],p=h[1],g=d!==v,j=d===v?"primary":"black",y=d===p?"primary":"black";c[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,t.jsx)(f.Text,{size:"2xl",children:"Результат"}),c[0]=n):n=c[0];var k=m[x[0]];c[1]!==j||c[2]!==k?(a=(0,t.jsx)(f.Text,{color:j,children:k}),c[1]=j,c[2]=k,c[3]=a):a=c[3],c[4]!==g||c[5]!==u?(i=(0,t.jsx)(b,{checked:g,onSwitch:u}),c[4]=g,c[5]=u,c[6]=i):i=c[6];var S=m[x[1]];return c[7]!==y||c[8]!==S?(o=(0,t.jsx)(f.Text,{color:y,children:S}),c[7]=y,c[8]=S,c[9]=o):o=c[9],c[10]!==a||c[11]!==i||c[12]!==o?(s=(0,t.jsxs)("header",{className:"flex justify-between",children:[n,(0,t.jsxs)("div",{className:"flex gap-3 items-center",children:[a,i,o]})]}),c[10]=a,c[11]=i,c[12]=o,c[13]=s):s=c[13],s},x=["demo","source"],p={demo:"Отображение",source:"Исходный код"},g={demo:"text",source:"html"},j=function(){var e,a,i,o,s,d=(0,r.c)(9),u=(0,l._)((0,n.useState)("demo"),2),h=u[0],b=u[1],x=c();d[0]===Symbol.for("react.memo_cache_sentinel")?(a=function(){b(y)},d[0]=a):a=d[0];var j=a,k=null==x||null==(e=x.data)?void 0:e[g[h]];return d[1]!==h?(i=(0,t.jsx)(v,{labels:p,mode:h,onToggle:j}),d[1]=h,d[2]=i):i=d[2],d[3]!==k||d[4]!==(null==x?void 0:x.data)?(o=(0,t.jsx)(m.Paper,{className:"flex-1",children:(null==x?void 0:x.data)?(0,t.jsx)(f.Text,{children:k}):(0,t.jsx)(f.Text,{color:"info",children:"Настройте параметры и запустите генерацию"})}),d[3]=k,d[4]=null==x?void 0:x.data,d[5]=o):o=d[5],d[6]!==i||d[7]!==o?(s=(0,t.jsxs)("section",{className:"flex flex-col flex-1 gap-3",children:[i,o]}),d[6]=i,d[7]=o,d[8]=s):s=d[8],s};function y(e){var t=(0,l._)(x,2),r=t[0],n=t[1];return e===r?n:r}}]);